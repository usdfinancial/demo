# Security Environment Variables Template
# Copy this to .env.local and fill in the values

# ===================================
# JWT CONFIGURATION (CRITICAL)
# ===================================
# Generate a strong secret: openssl rand -base64 64
JWT_SECRET=your-super-secure-jwt-secret-key-at-least-32-characters-long
JWT_ALGORITHM=HS256
JWT_ISSUER=USD-Financial
JWT_AUDIENCE=USD-Financial-API
JWT_EXPIRATION=24h

# For RSA-based JWT (more secure for distributed systems)
# JWT_ALGORITHM=RS256
# JWT_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----"
# JWT_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----"

# ===================================
# DATABASE SECURITY
# ===================================
# Main database connection
DATABASE_URL=postgresql://username:password@host:port/database?sslmode=require

# Direct connection (for migrations, optional)
DIRECT_URL=postgresql://username:password@host:port/database?sslmode=require

# SSL Configuration (optional, for custom certificates)
DB_SSL_CA=/path/to/ca-certificate.crt
DB_SSL_KEY=/path/to/client-key.key
DB_SSL_CERT=/path/to/client-certificate.crt

# Database connection limits
DATABASE_MAX_CONNECTIONS=20
DATABASE_CONNECTION_TIMEOUT=30000

# ===================================
# CORS CONFIGURATION
# ===================================
# Allowed origins (comma-separated)
CORS_ORIGIN=https://yourdomain.com,https://app.yourdomain.com

# ===================================
# RATE LIMITING
# ===================================
# Rate limit window in milliseconds (default: 15 minutes)
RATE_LIMIT_WINDOW_MS=900000

# Maximum requests per window (default: 1000)
RATE_LIMIT_MAX_REQUESTS=1000

# Authentication endpoint rate limiting (default: 5 attempts per 15 minutes)
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# ===================================
# CONTENT SECURITY POLICY
# ===================================
# CSP nonce for inline scripts (optional, auto-generated if not provided)
CSP_NONCE=

# Additional CSP directives (optional)
CSP_REPORT_URI=https://yourdomain.com/api/csp-report

# ===================================
# MONITORING & LOGGING
# ===================================
# Log level (error, warn, info, debug)
LOG_LEVEL=info

# Sentry DSN for error tracking (optional)
SENTRY_DSN=

# ===================================
# EXTERNAL SERVICES
# ===================================
# Email service configuration
# Choose provider: 'aws-ses', 'sendgrid', 'smtp'
EMAIL_PROVIDER=aws-ses
FROM_EMAIL=info@usd.financial

# AWS SES Configuration (Recommended)
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_SES_REGION=us-west-2

# Alternative: SendGrid
SENDGRID_API_KEY=your-sendgrid-api-key

# Alternative: SMTP fallback
SMTP_HOST=smtp.yourmailprovider.com
SMTP_PORT=587
SMTP_USER=your-smtp-username
SMTP_PASS=your-smtp-password

# SMS service (for 2FA)
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# ===================================
# CRYPTO & WEB3
# ===================================
# RPC endpoints
ETHEREUM_RPC_URL=https://eth-mainnet.alchemyapi.io/v2/your-api-key
POLYGON_RPC_URL=https://polygon-mainnet.alchemyapi.io/v2/your-api-key

# API keys for external services
ALCHEMY_API_KEY=your-alchemy-api-key
CIRCLE_API_KEY=your-circle-api-key
COINGECKO_API_KEY=your-coingecko-api-key

# ===================================
# SECURITY KEYS & SECRETS
# ===================================
# Encryption key for sensitive data (generate with: openssl rand -hex 32)
ENCRYPTION_KEY=your-64-character-hex-encryption-key

# CSRF token secret
CSRF_SECRET=your-csrf-secret-key

# ===================================
# DEVELOPMENT ONLY
# ===================================
# Enable debug logging in development
DEBUG=false

# Skip SSL verification in development (NEVER use in production)
NODE_TLS_REJECT_UNAUTHORIZED=1

# ===================================
# PRODUCTION SECURITY HEADERS
# ===================================
# Force HTTPS (production only)
FORCE_HTTPS=true

# HSTS max age (seconds)
HSTS_MAX_AGE=31536000

# ===================================
# FEATURE FLAGS
# ===================================
# Enable 2FA enforcement for admin users
ENFORCE_2FA_FOR_ADMIN=true

# Enable advanced rate limiting
ENABLE_ADVANCED_RATE_LIMITING=true

# Enable request logging
ENABLE_REQUEST_LOGGING=true

# Enable security audit logging
ENABLE_SECURITY_AUDIT_LOG=true